(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))a(t);new MutationObserver(t=>{for(const r of t)if(r.type==="childList")for(const s of r.addedNodes)s.tagName==="LINK"&&s.rel==="modulepreload"&&a(s)}).observe(document,{childList:!0,subtree:!0});function i(t){const r={};return t.integrity&&(r.integrity=t.integrity),t.referrerPolicy&&(r.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?r.credentials="include":t.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function a(t){if(t.ep)return;t.ep=!0;const r=i(t);fetch(t.href,r)}})();let E=document.getElementById("app"),v=document.createElement("div");v.id="listContainer";let o=document.createElement("ul");o.id="listUl";let h=document.createElement("div");h.id="headerContainer";let S=document.createElement("button");S.textContent="Statistics";let T=document.createElement("h1");T.id="headerContainerH1";T.textContent="Temperature/humidity Tracker";let w=document.createElement("h2");w.id="headerContainerH2";w.textContent="Sensor: DHT11";let f=document.createElement("div");f.id="headerTextContainer";let u=document.createElement("div"),D=document.createElement("div");D.id="buttonsContainer";u.id="navBar";let c=[],l="Today",y=document.createElement("button");y.id="latestEntry";y.textContent="Show latest entry";y.addEventListener("click",B);f.appendChild(T);f.appendChild(w);h.appendChild(f);E.appendChild(h);D.appendChild(S);D.appendChild(y);u.appendChild(D);h.appendChild(u);S.addEventListener("click",b);E.appendChild(v);v.appendChild(o);function A(){fetch("https://orca-app-il7tk.ondigitalocean.app/get-all-dht11-sensor-data").then(e=>e.json()).then(e=>{c=e,p(g()),C()})}function p(e){if(o.innerHTML="",!Array.isArray(e)||e.length===0){o.innerHTML="Ingen data tillgänglig.";return}console.log(l);let n=document.createElement("h1");n.id="listH1",n.innerText=`All Sensor Data For: ${l}`,o.appendChild(n),e.forEach(i=>{let a=document.createElement("li"),t=i.timeStamp.toString(),r=t.substring(0,10),s=t.substring(11,16);a.innerHTML=`Date: ${r} | Time: ${s} | Temperature: ${i.celsius}°C | Humidity: ${i.humidity}%`,o.appendChild(a)})}function B(){o.innerHTML="";let e=c[c.length-1],n=e.timeStamp.toString(),i=n.substring(0,10),a=n.substring(11,16),t=document.createElement("li");t.innerHTML=`Date: ${i} | Time: ${a} | Temperature: ${e.celsius}°C | Humidity: ${e.humidity}%`,o.appendChild(t)}function L(e){switch(e){case"Today":return g();case"Yesterday":return H();case"Last 3 days":return m(3);case"Last 7 days":return m(6);case"Last 30 days":return m(29);default:return c}}function m(e){const n=new Date,i=new Date(n);i.setHours(0,0,0,0),i.setDate(i.getDate()+1);const a=new Date(i);return a.setDate(a.getDate()-e),c.filter(t=>{const r=new Date(t.timeStamp);return r>=a&&r<i}).sort((t,r)=>new Date(r.timeStamp)-new Date(t.timeStamp))}function g(){const e=new Date,n=new Date(e);n.setHours(0,0,0,0),n.setDate(n.getDate()+1);const i=new Date(e);return i.setHours(0,0,0,0),c.filter(a=>{const t=new Date(a.timeStamp);return t>=i&&t<n}).sort((a,t)=>new Date(t.timeStamp)-new Date(a.timeStamp))}function H(){const e=new Date,n=new Date(e);n.setHours(0,0,0,0);const i=new Date(n);return i.setDate(i.getDate()-1),c.filter(a=>{const t=new Date(a.timeStamp);return t>=i&&t<n}).sort((a,t)=>new Date(t.timeStamp)-new Date(a.timeStamp))}function b(){o.innerHTML="",l="Today",C(p(g()));let e=document.createElement("div");e.id="selectionContainer";let n=document.createElement("label");n.textContent="Sorting Mode: ",n.setAttribute("for","dateSelection"),e.appendChild(n);let i=document.createElement("div");i.id="sortingModeContainer";let a=document.createElement("select");a.id="dateSelection",a.innerHTML=`
    <Select>
    <option value="Today">Today</option>
    <option value="Yesterday">Yesterday</option>
    <option value="Last 3 days">Last 3 days</option>
    <option value="Last 7 days">Last 7 days</option>
    <option value="Last 30 days">Last 30 days</option>
    `,a.addEventListener("change",()=>{I(),C()}),i.appendChild(n),i.appendChild(a),e.appendChild(i);let t=document.getElementById("selectionContainer");t&&u.removeChild(t);let r=document.createElement("button");r.id="showAllData",r.textContent=`Show all data for: ${l}`,r.addEventListener("click",()=>{console.log(l),p(L(l))}),e.appendChild(r),u.appendChild(e)}function I(){const e=document.getElementById("dateSelection").value,n=L(e);l=e,console.log(l);const i=document.getElementById("showAllData");i&&(i.textContent=`Show all data for: ${l}`),p(n)}function C(){let e=[];switch(l){case"Today":e=g();break;case"Yesterday":e=H();break;case"Last 3 days":e=m(3);break;case"Last 7 days":e=m(7);break;case"Last 30 days":e=m(30);break;default:console.log("");return}if(e.length===0){o.innerHTML="No Data Available";return}let n=0,i=0,a=Math.max(...e.map(d=>d.celsius)),t=Math.min(...e.map(d=>d.celsius)),r=Math.max(...e.map(d=>d.humidity)),s=Math.min(...e.map(d=>d.humidity));e.forEach(d=>{n+=d.celsius,i+=d.humidity});let x=e.length,M=(n/e.length).toFixed(2),$=(i/e.length).toFixed(2);o.innerHTML=`
    <div id="statsH1Container">
    <li><h1 id=statsH1>Statistics for: ${l}</h1></li>
    </div>
    <div id="averageContainer" class="flexContainer">
    <li>Avg Temp: ${M}°C</li>
    <li>Avg Humidity: ${$}%</li>
    </div>
    <div id="tempContainer" class="flexContainer">
    <li>Highest Temp: ${a}°C</li>
    <li>Lowest Temp: ${t}°C</li>
    </div>
    <div id="humidityContainer" class="flexContainer">
    <li>Highest Humidity: ${r}%</li>
    <li>Lowest Humidity: ${s}%</li>
    </div>
    <div id="entriesContainer" class="flexContainer">
    <li>Number of entries: ${x}</li>
    </div>
  `}A();b();
